



<!DOCTYPE html>
<html lang="zh-CN">

<head>
<title>端到端的机器学习项目（Machine Learning 研习之六）</title>
<meta name="viewport"content="width=device-width, user-scalable=no, initial-scale=1.0, shrink-to-fit=no, viewport-fit=cover">

<meta name="description" content="端到端的机器学习项目（Machine Learning 研习之六）">

<meta itemprop="name" content="端到端的机器学习项目（Machine Learning 研习之六）">
<meta itemprop="description" content="端到端的机器学习项目（Machine Learning 研习之六）">
<meta itemprop="image" content="/img/author.jpg">


<meta name="twitter:description" content="端到端的机器学习项目（Machine Learning 研习之六）" />


<link rel="alternate" href="/feed.xml" title="秋码分享" type="application/rss+xml"/>

<link rel="shortcut icon" href="/imgs/icons/favicon.ico"/>
<link rel="apple-touch-icon" href="/imgs/icons/apple-touch-icon.png" />
<link rel="apple-touch-icon-precomposed" href="/imgs/icons/apple-touch-icon.png" />




<style>
    @font-face {
        font-family: 'Xc Font';
        font-weight: 400;
        font-style: normal;
        font-display: swap;
        src: url('https://cdn.jsdelivr.net/gh/Xpblog666/cdn@1.0/HarmonyOS_Sans_SC_Medium.ttf');
        src: url('https://cdn.jsdelivr.net/gh/Xpblog666/cdn@1.0/HarmonyOS_Sans_SC_Medium.ttf') format('truetype');
    }

    html {
        font-family: 'Xc Font', 'PingFang SC', 'Noto Serif SC', 'HarmonyOS_Sans_SC_Medium', 'Fira Mono', 'Microsoft YaHei', Arial, sans-serif
    }

    html .Qc_header_above .Qc_container {
        max-width: 1720px
    }

    html .Qc_header_below .Qc_container {
        max-width: 1720px
    }

    html .Qc_header_searchout .Qc_container {
        max-width: 1720px
    }

    html .Qc_main {
        max-width: 980px
    }

    html .Qc_aside {
        width: 260px
    }

    body::before {
        background: #f0f0f0;
        background: ;
        background-position: center 0;
        background-repeat: no-repeat;
        background-size: cover;
    }
</style>


<link rel="stylesheet" href="/css/global.min.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/theme.min.css" />

<link rel="stylesheet" href="/css/font-awesome.min.css" />


<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css" />







































<script type="module">
    import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
  
    init({
      el: '.waline-container',
      placeholder: "请不要吝啬您的评论 ヾ(≧▽≦*)o",
      sofa: "瞧，这里没人，还不抢占第一的位置 (≧∀≦)ゞ",
      pageview: true, 
      comment: true, 
      emoji: [
        '//unpkg.com/@waline/emojis@1.1.0/weibo',
        '//unpkg.com/@waline/emojis@1.1.0/bilibili',
      ],
      login: 'disable',
      imgUploader: false,
      wordLimit: 200,
      requiredMeta: ['nick', 'mail'],
      reaction: true,
      reactionText: [ '点赞', '踩一下', '得意', '不屑', '尴尬', '睡觉'],
      reactionTitle: "您认为这篇文章怎么样？",
      dark: 'auto', 
      serverURL: "comment.qiucode.cn",
    });
  </script>
  









 
 


  
  









    
    







                
 
    

























</head>

<body>
	<header class="Qc_header  active Qc_slid">
<div class="Qc_header_above">
    <div class="Qc_container"> 
        <svg class="Qc_header_above-slideicon" viewBox="0 0 1152 1024"
            xmlns="http://www.w3.org/2000/svg" width="20" height="20">
            <path
                d="M76.032 872a59.968 59.968 0 1 0 0 120h999.936a59.968 59.968 0 1 0 0-120H76.032zm16-420.032a59.968 59.968 0 1 0 0 120h599.936a59.968 59.968 0 1 0 0-119.936H92.032zM76.032 32a59.968 59.968 0 1 0 0 120h999.936a60.032 60.032 0 0 0 0-120H76.032z" />
        </svg> 
        <a class="Qc_header_above-logo" href="/" title="John'Blog"> 
            <img class="Qc_logo"
                src="/static/front/images/qiu-logo.png" /></a>
        <nav class="Qc_header_above_nav"> 
            
            <a class="item " href="/" title="首页" style="margin-right:8px">
                <i class="fa fa-home"></i> 首页
            </a>
           
            <a class="item " href="/flinks" title="友情链接">
                <i class="fa fa-link"></i>友情链接
            </a> 

            

            <a class="item " href="/about" title="关于我">
                <i class="fa fa-user"></i>关于本站
            </a>
        </nav> 

        
        
        <svg class="Qc_header_above-searchicon" viewBox="0 0 1024 1024"
            xmlns="http://www.w3.org/2000/svg" width="20" height="20" style="display: block;">
            <path
                d="M1008.19 932.031L771.72 695.56a431.153 431.153 0 1 0-76.158 76.158l236.408 236.472a53.758 53.758 0 0 0 76.158 0 53.758 53.758 0 0 0 0-76.158zM107.807 431.185a323.637 323.637 0 0 1 323.316-323.381 323.7 323.7 0 0 1 323.381 323.38 323.637 323.637 0 0 1-323.38 323.317 323.637 323.637 0 0 1-323.317-323.316z" />
        </svg> 
        <a href="javascript:void(0)" type="button" id="ClickMe" style="margin: 0px 3px 2px 13px"><svg
                t="1675873194952" class="loingico" viewBox="0 0 1024 1024" version="1.1"
                xmlns="http://www.w3.org/2000/svg" p-id="3929" width="22" height="22">
                <path
                    d="M554.666667 349.44a48.213333 48.213333 0 1 1-47.786667 47.786667A48.213333 48.213333 0 0 1 554.666667 349.44m0-85.333333a133.546667 133.546667 0 1 0 133.546666 133.12A133.12 133.12 0 0 0 554.666667 264.106667z"
                    fill="var(--routine)" p-id="3930"></path>
                <path
                    d="M768 759.893333a42.666667 42.666667 0 0 1-42.666667-42.666666 170.666667 170.666667 0 0 0-341.333333 0 42.666667 42.666667 0 0 1-85.333333 0 256 256 0 0 1 512 0 42.666667 42.666667 0 0 1-42.666667 42.666666z"
                    fill="var(--routine)" p-id="3931"></path>
                <path
                    d="M554.666667 213.333333a341.333333 341.333333 0 1 1-341.333334 341.333334 341.333333 341.333333 0 0 1 341.333334-341.333334m0-85.333333a426.666667 426.666667 0 1 0 426.666666 426.666667A426.666667 426.666667 0 0 0 554.666667 128z"
                    fill="var(--routine)" p-id="3932"></path>
            </svg> </a>
        
        
        

    </div>
</div>
<div class="Qc_header_searchout">
    <div class="Qc_container">
        <div class="Qc_header_searchout_all">
            <div class="Qc_search_inner">
                <div class="Qc_label">
                    <div class="title"> <i class="iconfont icon-A70"
                            style="margin-right: 5px;font-size: 18px;"></i> 关键词搜索 </div>
                    <form class="search" method="post" action="/"> <input maxlength="16"
                            autocomplete="off" placeholder="请输入关键字..." name="s" value="" class="input"
                            type="text" /> <button type="submit" class="submit">搜索</button> </form>
                    <div class="title"> <i class="iconfont icon-A67"
                            style="margin-right: 5px;font-size: 18px;"></i>标签搜索</div>
                    <ul class="cloud">
                        <li class="item"><a style="background:#0396FF"
                                href="https://qiucode.cntag/%E5%A4%96%E8%B4%B8/">外贸</a></li>
                        <li class="item"><a style="background:#0396FF"
                                href="https://qiucode.cntag/%E5%A4%96%E8%B4%B8%E5%88%86%E4%BA%AB/">外贸分享</a></li>
                        <li class="item"><a style="background:#E96D71"
                                href="https://qiucode.cntag/%E5%A4%96%E8%B4%B8%E8%AF%9D%E6%9C%AF/">外贸话术</a></li>
                        <li class="item"><a style="background:#FD6585"
                                href="https://qiucode.cntag/typecho/">typecho</a></li>
                        <li class="item"><a style="background:#e8583d"
                                href="https://qiucode.cntag/chatgpt/">chatgpt</a></li>
                        <li class="item"><a style="background:#FA742B"
                                href="https://qiucode.cntag/typecho%E6%8F%92%E4%BB%B6/">typecho插件</a></li>
                        <li class="item"><a style="background:#4C83FF"
                                href="https://qiucode.cntag/%E5%AD%97%E4%BD%93%E7%BE%8E%E5%8C%96/">字体美化</a></li>
                        <li class="item"><a style="background:#f093fb"
                                href="https://qiucode.cntag/%E5%9B%BD%E5%86%85ChatGPT/">国内ChatGPT</a></li>
                        <li class="item"><a style="background:#F072B6"
                                href="https://qiucode.cntag/openwrt/">openwrt</a></li>
                        <li class="item"><a style="background:#f68e5f"
                                href="https://qiucode.cntag/%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81/">网站源码</a></li>
                        <li class="item"><a style="background:#e8583d"
                                href="https://qiucode.cntag/%E7%BA%A2%E7%B1%B3ax6000/">红米ax6000</a></li>
                        <li class="item"><a style="background:#4facfe"
                                href="https://qiucode.cntag/AI%E7%BB%98%E5%9B%BE/">AI绘图</a></li>
                        <li class="item"><a style="background:#0396FF"
                                href="https://qiucode.cntag/GPTalk/">GPTalk</a></li>
                        <li class="item"><a style="background:#6fa3ef"
                                href="https://qiucode.cntag/AALocker/">AALocker</a></li>
                        <li class="item"><a style="background:#49C628"
                                href="https://qiucode.cntag/%E4%BC%9A%E5%91%98%E9%9B%B6%E5%85%83%E8%B4%AD/">会员零元购</a>
                        </li>
                        <li class="item"><a style="background:#736EFE"
                                href="https://qiucode.cntag/ai%E6%95%B0%E5%AD%97%E7%BB%98%E7%94%BB/">ai数字绘画</a>
                        </li>
                        <li class="item"><a style="background:#F072B6" href="https://qiucode.cntag/Ai/">Ai</a>
                        </li>
                        <li class="item"><a style="background:#465EFB"
                                href="https://qiucode.cntag/Stable-Diffusion/">Stable Diffusion</a></li>
                        <li class="item"><a style="background:#E96D71"
                                href="https://qiucode.cntag/%E5%8D%9A%E5%AE%A2/">博客</a></li>
                        <li class="item"><a style="background:#6fa3ef"
                                href="https://qiucode.cntag/win11/">win11</a></li>
                    </ul>
                    <div class="title" style="padding: 15px 0 0 0"> <i class="iconfont icon-A89"
                            style="margin-right: 5px;font-size: 18px;"></i>近期浏览</div>
                    <div id="jl_viewHistory" style="display: block"></div>
                </div>
                <div class="Qc_article">
                    <div class="title"> <i class="iconfont icon-A37"
                            style="margin-right: 5px;font-size: 18px;"></i>热门文章</div>
                    <div class="Qc_header_search" style="position: relative;">
                        <nav class="result"> <a href="https://qiucode.cna/7/" title="本主题—Joe魔改 一款个人类型Typecho主题"
                                class="item"> <span class="sort">1</span> <span class="text">本主题—Joe魔改
                                    一款个人类型Typecho主题</span> <span class="views"></i>3.8k 阅读</span> </a> <a
                                href="https://qiucode.cna/28/" title="红米Redmi AX6000开启并固化SSH简单方法+刷openwrt固件"
                                class="item"> <span class="sort">2</span> <span class="text">红米Redmi
                                    AX6000开启并固化SSH简单方法+刷openwrt固件</span> <span class="views"></i>2.3k 阅读</span>
                            </a> <a href="https://qiucode.cna/14/"
                                title="最新可用 Typecho 付费阅读插件修复版-免登录版-免授权-对接第三方支付" class="item"> <span
                                    class="sort">3</span> <span class="text">最新可用 Typecho
                                    付费阅读插件修复版-免登录版-免授权-对接第三方支付</span> <span class="views"></i>1.9k 阅读</span>
                            </a> <a href="https://qiucode.cna/17/" title="Typecho七牛云插件，为您的网站访问加速" class="item">
                                <span class="sort">4</span> <span class="text">Typecho七牛云插件，为您的网站访问加速</span>
                                <span class="views"></i>1.6k 阅读</span> </a> <a href="https://qiucode.cna/16/"
                                title="Typecho投稿功能开启——无需插件，一行代码" class="item"> <span class="sort">5</span> <span
                                    class="text">Typecho投稿功能开启——无需插件，一行代码</span> <span class="views"></i>1.4k
                                    阅读</span> </a> <a href="https://qiucode.cna/36/"
                                title="Typecho使用CDN后无法登陆后台解决办法" class="item"> <span class="sort">6</span> <span
                                    class="text">Typecho使用CDN后无法登陆后台解决办法</span> <span class="views"></i>733
                                    阅读</span> </a> <a href="https://qiucode.cna/1/" title="欢迎使用 Typecho"
                                class="item"> <span class="sort">7</span> <span class="text">欢迎使用 Typecho</span>
                                <span class="views"></i>637 阅读</span> </a> <a href="https://qiucode.cna/26/"
                                title="十个金句搞定外贸客户已读不回✅" class="item"> <span class="sort">8</span> <span
                                    class="text">十个金句搞定外贸客户已读不回✅</span> <span class="views"></i>543 阅读</span>
                            </a> <a href="https://qiucode.cna/24/" title="如何支持发送Emoji表情？" class="item"> <span
                                    class="sort">9</span> <span class="text">如何支持发送Emoji表情？</span> <span
                                    class="views"></i>508 阅读</span> </a> </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="Qc_header_slideout"> 
    <img width="100%" height="150" class="Qc_header_slideout-image"
        src="https://qiucode.cnshaonv.jpg" alt="侧边栏壁纸" />
    <div class="Qc_header_slideout-author"> <img width="50" height="50" class="avatar"
            src="https://thirdqq.qlogo.cn/g?b=qq&nk=687778&s=100" alt="博主昵称" />
        <div class="info"> <a class="link" href="https://xx9q.com" target="_blank"
                rel="noopener noreferrer nofollow">John</a>
            <p class="motto Qc_motto"></p>
        </div>
    </div>
    <ul class="Qc_header_slideout-count"> </ul>
    <ul class="Qc_header_slideout-menu panel-box">
        <li> <a class="link" href="https://qiucode.cn" title="首页"> <span><i class="iconfont icon-A131"></i>
                    首页</span> </a> </li>
        <li> <a class="link panel" href="#" rel="nofollow"> <span><i class="iconfont icon-A129"></i> 分类</span>
                <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                    height="13">
                    <path
                        d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                </svg> </a>
            <ul class="slides panel-body panel-box">
                <li>
                    <div class="link panel "> <a href="https://qiucode.cncategory/default/" title="日常分享">日常分享</a>
                        <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                            height="13">
                            <path
                                d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                        </svg> </div>
                    <ul class="slides panel-body">
                        <li><a class="link " href="https://qiucode.cncategory/wmfx/" title="外贸分享">外贸分享</a></li>
                        <li><a class="link " href="https://qiucode.cncategory/wztj/" title="网站推荐">网站推荐</a></li>
                        <li><a class="link " href="https://qiucode.cncategory/yxxg/" title="游戏相关">游戏相关</a></li>
                    </ul>
                </li>
                <li><a class="link " href="https://qiucode.cncategory/xitong/" title="系统相关">系统相关</a></li>
                <li>
                    <div class="link panel "> <a href="https://qiucode.cncategory/wangzhan/"
                            title="网站文档">网站文档</a> <svg class="icon" viewBox="0 0 1024 1024"
                            xmlns="http://www.w3.org/2000/svg" width="13" height="13">
                            <path
                                d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                        </svg> </div>
                    <ul class="slides panel-body">
                        <li><a class="link " href="https://qiucode.cncategory/bkfx/" title="博客分享">博客分享</a></li>
                        <li><a class="link " href="https://qiucode.cncategory/wzym/" title="网站源码">网站源码</a></li>
                    </ul>
                </li>
                <li>
                    <div class="link panel "> <a href="https://qiucode.cncategory/ruanjian/"
                            title="软件分享">软件分享</a> <svg class="icon" viewBox="0 0 1024 1024"
                            xmlns="http://www.w3.org/2000/svg" width="13" height="13">
                            <path
                                d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                        </svg> </div>
                    <ul class="slides panel-body">
                        <li><a class="link " href="https://qiucode.cncategory/sjrj/" title="📱手机软件">📱手机软件</a>
                        </li>
                        <li><a class="link " href="https://qiucode.cncategory/dnrj/" title="💻电脑软件">💻电脑软件</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>
        <li> <a class="link panel" href="#" rel="nofollow"> <span><i class="iconfont icon-A3"></i> 页面</span>
                <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                    height="13">
                    <path
                        d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z" />
                </svg> </a>
            <ul class="slides panel-body">
                <li><a class="link " href="https://qiucode.cnsn.html" title="我的记录">我的记录</a></li>
                <li><a class="link " href="https://qiucode.cnyoulian.html" title="友情链接">友情链接</a></li>
                <li><a class="link " href="https://qiucode.cnsite.html" title="站点统计">站点统计</a></li>
                <li><a class="link " href="https://qiucode.cnAboutme.html" title="关于我">关于我</a></li>
            </ul>
        </li>
    </ul>
    <ul class="Qc_header_slideout-menu panel-box" style="margin-top: 15px;margin-bottom: 100px;">
        <li> <a class="link panel" href="#" rel="nofollow"> <span><i class="iconfont icon-A17"></i> 用户登录</span>
                <svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="13"
                    height="13">
                    <path
                        d="M624.865 512.247L332.71 220.088c-12.28-12.27-12.28-32.186 0-44.457 12.27-12.28 32.186-12.28 44.457 0l314.388 314.388c12.28 12.27 12.28 32.186 0 44.457L377.167 848.863c-6.136 6.14-14.183 9.211-22.228 9.211s-16.092-3.071-22.228-9.211c-12.28-12.27-12.28-32.186 0-44.457l292.155-292.16z">
                    </path>
                </svg> </a>
            <ul class="slides panel-body">
                <li> <a class="link" href="https://qiucode.cnadmin/login.php" target="_blank"
                        rel="noopener noreferrer nofollow">登录</a> <a class="link"
                        href="https://qiucode.cnadmin/register.php" target="_blank"
                        rel="noopener noreferrer nofollow">注册</a> </li>
            </ul>
        </li>
    </ul>
</div>
<div class="Qc_header_mask"></div>

<script>

    let sideBtn = document.querySelector(".Qc_header_above .Qc_container .Qc_header_above-slideicon")

    sideBtn.addEventListener("click", () => {
        document.querySelector(".Qc_header_slideout").classList.add("active")
        document.querySelector(".Qc_header_mask").classList.add("active")
    })

    let maskBtn = document.querySelector(".Qc_header_mask")

    maskBtn.addEventListener("click",() => {
        document.querySelector(".Qc_header_slideout").classList.remove("active")
        maskBtn.classList.remove("active")
    })

   
    

</script></header>
	
		
	<div class="Qc_container showInUp">



<div class="Qc_main Qc_post">
    <div class="Qc_detail">
        <h1 class="title Qc_psot_title"> 端到端的机器学习项目（Machine Learning 研习之六）</h1>
        <div class="Qc_bread">
            <ul class="Qc_bread_bread">
                <li class="item"> <span class="iconfont icon-A131" style="margin-right: 4px;"></span> <a
                        href="https://qiucode.cn" class="link" title="首页">首页</a> </li>
                <li class="line">/</li>
                <li class="item"> <a class="link" href="https://qiucode.cncategory/bkfx/" title="博客分享">博客分享</a>
                </li>
                <li class="line">/</li>
                <li class="item">正文</li>
            </ul>
        </div>
        <div class="Qc_detail_category"> </div>
        <article class="Qc_detail_article" id="article-container">
            <p>Scikit-Learn提供了一些函数，以各种方式将数据集拆分为多个子集。最简单的函数train_test_split()，它的功能与我们前面定义的shuffle_and_split_data ()函数非常相似，只是增加了几个特性。首先，有一个random_state参数，它允许您设置随机生成器种子。其次，您可以向它传递具有相同行数的多个数据集，它将按照相同的索引将它们拆分(这是非常有用的，例如，如果你有一个单独的DataFrame标签)</p>
<h3 id="使用真实数据">使用真实数据</h3>
<p>当你在研习<code>机器学习</code>时，最好是使用真实世界中的数据，而不是采用人工数据。巧的是，数以千计的数据集可供选择，涵盖了各种领域。</p>
<ul>
<li>流行的开放数据存储库：
<ul>
<li><a href="https://openml.org/">OpenML.org</a></li>
<li><a href="https://kaggle.com/datasets">Kaggle.com</a></li>
<li><a href="https://paperswithcode.com/datasets">paperswithcode.com</a></li>
<li><a href="https://archive.ics.uci.edu/ml"> UC Irvine Machine Learning Repository</a></li>
<li><a href="https://registry.opendata.aws/">Amazon’s AWS datasets</a></li>
<li><a href="https://tensorflow.org/datasets"> TensorFlow datasets</a></li>
</ul>
</li>
<li>元门户数据库：
<ul>
<li><a href="https://dataportals.org/"> DataPortals.org</a></li>
<li><a href="https://opendatamonitor.eu/"> OpenDataMonitor.eu</a></li>
</ul>
</li>
<li>其他流行的开房数据集：
<ul>
<li><a href="https://homl.info/9"> Wikipedia’s list of machine learning datasets</a></li>
<li><a href="https://homl.info/10"> Quora.com</a></li>
<li><a href="https://reddit.com/r/datasets"> The datasets subreddit</a></li>
</ul>
</li>
</ul>
<p>本文数据来自于 StatLib 仓库的加州房价数据（见下图），它是基于 1990 年加利福尼亚州人口普查的数据，而不是最近的数据，不必过于纠结，我们的重心在于研习<code>机器学习</code>，并非是在讨论房价的问题。</p>
<p><img src="https://img-blog.csdnimg.cn/2c4a8b5ab93f4e2388c34b1d5084e718.png#pic_center" alt="在这里插入图片描述"></p>
<h3 id="看图说话">看图说话</h3>
<p><code>机器学习</code>的首要任务，是利用加州人口普查数据，建立一个该州房价的模型。你的模型应该从这些数据中学习，并能够在给定所有其他指标的情况下，预测任何地区的房屋中位数价格。</p>
<h3 id="框架问题">框架问题</h3>
<p>建立一个模型可能并不是最终目标，公司期望使用该模式如何从中获益？故而，了解目标是至关重要的，因为它将决定该如何去构建问题、将选择哪些算法、将使用哪些性能度量来评估您的模型，以及您将花费多少精力来调整它。</p>
<p>你的模型的输出(一个地区的房价中位数的预测)将被馈送到另一个机器学习系统(见下图)，以及许多其他的这个下游系统将决定它是否值得在一个给定的领域投资。做好这一点至关重要，因为它直接影响收入。</p>
<p>目前的解决方案是什么样的(如果有的话)。目前的情况往往会给你一个性能的参考，以及如何解决问题
的见解。该地区的房价目前是由专家手动估算的一个团队收集有关该地区的最新信息，当他们无法得到房价中位数时，他们使用复杂的规则来估算。</p>
<p><img src="https://img-blog.csdnimg.cn/a51c65402bdb42638c9b837ca255da25.png#pic_center" alt="在这里插入图片描述"></p>
<p>这既费钱又费时，而且他们的估计也不准确，在他们设法找出实际中位房价的情况下，他们常常意识到自己的估计误差超过30%。这就是为什么该公司认为，考虑到有关该地区的其他数据，建立一个预测该地区房价中值的模型将是有用的。人口普查数据看起来是一个很好的数据集，因为它包
括数千个地区的房屋价格中位数，以及其他数据。</p>
<blockquote>
<p>管道</p>
<p>数据处理组件的序列称为数据管道。管道在机器学习系统中非常常见，因为有很多数据要操作，很多数据转换要应用。</p>
<p>组件通常异步运行。每个组件都拉入大量数据，对其进行处理，并将结果吐出到另一个数据存储中。然后，过了一段时间，管道中的下一个组件拉入该数据并输出它自己的输出。每个组件都是相当独立的:组件之间的接口仅仅是数据存储。这使得系统易于掌握(借助数据流
图)，不同的团队可以专注于不同的组件。此外，如果一个组件坏了下游组件通常可以继续正常运行(至少一段时间)，只需要使用坏掉的组件的最后一个输出。这使得体系结构相当健壮。</p>
<p>另一方面，如果没有实现适当的监视，一个损坏的组件可能在一段时间内不会被注意到。数据变得陈旧，整个系统的性能下降。</p>
</blockquote>
<p>虽然有了这些信息，可以开始设计你的系统，但请回答，它是监督、无监督、半监督、自我监督、或强化学习任务？它是一个分类任务、回归任务，抑或是其它别的什么？你应该使用批量学习还是在线学习技术呢？</p>
<p>你能回答出来了吗？这显然是一个典型的监督学习任务，因为模型可以用带标签的示例进行训练(每个示例都带有预期输出，即该地区的房价中值)。这是一个典型的回归任务，因为模型将被要求预测一个值。更具体地说，这是一个多元回归问题，因为系统将使用多个特征进行预测(地区的人口、中位数收入等)。这也是一个单变量回归问题，因为我们只是试图预测每个地区的一个单一值。如果我们试图预测每个地区的多个值，这将是一个多元回归问题。最后，没有连续的数据流进入系统，没有特别的需要来适应快速变化的数据，数据足够小，可以放入内存中，所以普通的批处理学习应该做得很好。</p>
<h3 id="选择性能度量">选择性能度量</h3>
<p>回归问题的一个典型性能度量是均方根误差(RMSE)。它给出了系统在其预测中通常会产生多大误差的概念，较大误差的权重较高。公式给出了计算RMSE的数学公式。</p>
<p><img src="https://img-blog.csdnimg.cn/936007acfa764c9f93a81ddd6a1cbf43.png#pic_center" alt="在这里插入图片描述"></p>
<blockquote>
<p>注意：</p>
<p>这个方程介绍了我将在本书中使用的几个非常常见的机器学习符号：</p>
<ul>
<li>
<p>m 是您测量RMSE 的数据集中的实例数。</p>
<p>例如，如果您在 2,000 个地区的验证集上评估 RMSE，则 m = 2,000。</p>
</li>
<li>
<p>x(i) 是数据集中第i 个实例的所有特征值（不包括标签）的向量，y(i) 是其标签（该实例的所需输出值）。 例如，如果数据集中的第一个区位于经度 –118.29°，纬度 33.91°，有 1,416 名居民，收入中位数为 38,372 美元，房屋价值中位数为 156,400 美元（暂时忽略其他特征）， 然后：</p>
<p><img src="https://img-blog.csdnimg.cn/02bdf75dfb014e949b074d7b3f17ea81.png#pic_center" alt="在这里插入图片描述"></p>
</li>
</ul>
</blockquote>
<blockquote>
<p>和：</p>
<p><img src="https://img-blog.csdnimg.cn/cad0342b3605498097407b06a4464980.png#pic_center" alt="在这里插入图片描述"></p>
</blockquote>
<blockquote>
<ul>
<li>
<p>X是一个矩阵，包含数据集中所有实例的所有特征值（不包括标签）。 每个实例一行，第 i 行等于 x(i) 的转置，记为 (x(i))⊺.3 — 例如，如果第一区如上所述，则矩阵 X 如下所示：</p>
<p><img src="https://img-blog.csdnimg.cn/08cdb9f135b54b8196807bf5cf84427a.png#pic_center" alt="在这里插入图片描述"></p>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>
<p>h 是系统的预测函数，也称为假设。 当给定系统一个实例的特征向量 x(i) 时，它会输出该实例的预测值 ŷ(i) = h(x(i))（ŷ 发音为“y-hat”）。 — 例如，如果您的系统预测第一区的房价中位数为 158,400 美元，则 ŷ(1) = h(x(1)) = 158,400。 该地区的预测误差为 ŷ(1) – y(1) = 2,000。</p>
</li>
<li>
<p>MSE(X,h) 是使用假设 h 在一组示例上测量的成本函数。</p>
</li>
</ul>
<p>我们使用小写斜体表示标量值（例如 m 或 y(i)）和函数名称（例如 h），使用小写粗体表示向量（例如 x(i)），使用大写粗体表示矩阵（例如 X）。</p>
</blockquote>
<p>尽管<code>RMSE</code>通常是回归任务的首选性能度量，但在某些上下文中，您可能更喜欢使用其他函数。例如，如果有许多离群的地区。在这种情况下，你可以考虑使用平均绝对误差(MAE，也称为平均绝对偏差)，如下公式所示：</p>
<p><img src="https://img-blog.csdnimg.cn/df271efe349c47f0921f5d5fb9fec219.png#pic_center" alt="在这里插入图片描述"></p>
<p><code>RMSE</code>和<code>MAE</code>都是度量两个向量之间距离的方法:预测向量和目标值向量。各种距离测量或规范是可能的:</p>
<ul>
<li>计算平方和的根 (RMSE) 对应于欧几里得范数：这是我们都熟悉的距离概念。 它也称为 ℓ2 范数，记作 ∥ · ∥2（或简称 ∥ · ∥）。</li>
<li>计算绝对值之和 (MAE) 对应于 ℓ1 范数，记为 ∥ · ∥1。 这有时被称为曼哈顿范数，因为如果您只能沿着正交的城市街区行驶，它会测量城市中两点之间的距离。</li>
<li>更一般地，包含 n 个元素的向量 v 的 ℓk 范数定义为 ∥v∥k = (|v1|k + |v2|k + &hellip; + |vn|k)1/k。 ℓ0 给出向量中非零元素的数量，ℓ∞ 给出向量中的最大绝对值。</li>
</ul>
<p>范数指数越高，越注重大值而忽视小值。 这就是 RMSE 比 MAE 对异常值更敏感的原因。 但是，当异常值呈指数级稀有时（例如在钟形曲线中），RMSE 表现非常好并且通常是首选。</p>
<h3 id="检查假设">检查假设</h3>
<p>最后，列出并验证到目前为止(您或其他人)所做的假设是一个很好的实践，这可以帮助您尽早发现严重的问题。例如，您的系统输出的地区价格将被输入到下游机器学习系统，并且您假设这些价格将被如此使用。但是，如果下游系统将价格转换成类别(例如，“便宜”、“中等”或“昂贵”)，然后使用这些类别而不是价格本身呢?在这种情况下，获得完全正确的价格一点也不重要;您的系统只需要获得正确的类别。如果是这样的话，那么这个问题应该被定义为一个分类任务，而不是一个回归任务。你不想在做了几个月的回归系统之后发现这个问题。</p>
<p>幸运的是，在与负责下游系统的团队交谈后，您确信他们确实需要实际价格，而不仅仅是类别。太好了!一切就绪，绿灯亮了，现在就可以开始编码了!</p>
<h3 id="下载数据">下载数据</h3>
<p>在典型环境中，您的数据可在关系数据库或其他一些常见数据存储中使用，。</p>
<p>要访问它，您首先需要获取凭据和访问授权并熟悉数据架构。 然而，在这个项目中，事情要简单得多：您只需下载一个压缩文件 housing.tgz，其中包含一个名为 housing.csv 的逗号分隔值 (CSV) 文件以及所有数据。</p>
<p>通常最好编写一个函数来为您执行此操作，而不是手动下载和解压缩数据。 如果数据定期更改，这尤其有用：您可以编写一个小脚本，使用该函数来获取最新数据（或者您可以设置一个计划作业以定期自动执行此操作）。 如果您需要在多台计算机上安装数据集，自动化获取数据的过程也很有用。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pathlib <span style="color:#f92672">import</span> Path
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tarfile
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_housing_data</span>():
</span></span><span style="display:flex;"><span>    tarball_path <span style="color:#f92672">=</span> Path(<span style="color:#e6db74">&#34;datasets/housing.tgz&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> tarball_path<span style="color:#f92672">.</span>is_file():
</span></span><span style="display:flex;"><span>        Path(<span style="color:#e6db74">&#34;datasets&#34;</span>)<span style="color:#f92672">.</span>mkdir(parents<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, exist_ok<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://github.com/ageron/data/raw/main/housing.tgz&#34;</span>
</span></span><span style="display:flex;"><span>        urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlretrieve(url, tarball_path)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> tarfile<span style="color:#f92672">.</span>open(tarball_path) <span style="color:#66d9ef">as</span> housing_tarball:
</span></span><span style="display:flex;"><span>            housing_tarball<span style="color:#f92672">.</span>extractall(path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;datasets&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> pd<span style="color:#f92672">.</span>read_csv(Path(<span style="color:#e6db74">&#34;datasets/housing/housing.csv&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>housing <span style="color:#f92672">=</span> load_housing_data()
</span></span></code></pre></div><p>当调用 load_housing_data() 时，它会查找 datasets/housing.tgz 文件。 如果没有找到，它会在当前目录中创建 datasets 目录，从 Ageron/data GitHub 存储库下载 housing.tgz 文件，并将其内容提取到 datasets 目录中 ; 这将创建 datasets/housing 目录，其中包含 housing.csv 文件。 最后，该函数将此 CSV 文件加载到包含所有数据的 Pandas DataFrame 对象中，并返回它。</p>
<h3 id="创建测试集">创建测试集</h3>
<p>在这个阶段自愿搁置部分数据可能看起来很奇怪。 毕竟，您只是快速浏览了一下数据，在决定使用哪些算法之前，您当然应该了解更多相关信息，对吗？ 这是事实，但你的大脑是一个令人惊奇的模式检测系统，这也意味着它很容易过度拟合：如果你查看测试集，你可能会在测试数据中偶然发现一些看似有趣的模式，从而引导你选择 一种特殊的机器学习模型。 当您使用测试集估计泛化误差时，您的估计将过于乐观，并且您将启动一个性能不如预期的系统。 这称为数据窥探偏差。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">shuffle_and_split_data</span>(data, test_ratio):
</span></span><span style="display:flex;"><span>    shuffled_indices <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>permutation(len(data))
</span></span><span style="display:flex;"><span>    test_set_size <span style="color:#f92672">=</span> int(len(data) <span style="color:#f92672">*</span> test_ratio)
</span></span><span style="display:flex;"><span>    test_indices <span style="color:#f92672">=</span> shuffled_indices[:test_set_size]
</span></span><span style="display:flex;"><span>    train_indices <span style="color:#f92672">=</span> shuffled_indices[test_set_size:]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> data<span style="color:#f92672">.</span>iloc[train_indices], data<span style="color:#f92672">.</span>iloc[test_indices]
</span></span></code></pre></div><p>好了，这个工作，但它并不完美:如果你再次运行这个程序，它将生成一个不同的测试集!随着时间的推移，你(或你的机器学习算法)将看到整个数据集，这是你要避免的</p>
<p>一种解决方案是在第一次运行时保存测试集，然后在后续运行中加载。另一个选项是在调用np.random.permutation()之前设置随机数生成器的seed(例如，使用np.random.seed(42))。，以便它总是生成相同的打乱索引。</p>
<p>但是，这两种解决方案在下次获取更新的数据集时都会中断。即使在更新数据集之后也要进行稳定的训练/测试分割，常见的解决方案是使用每个实例的标识符来决定是否应该在测试集中运行(假设实例具有唯一和不可变的标识符)。例如，如果哈希值低于或等于最大哈希值的20%，则可以计算每个实例的标识符的散列，并将该实例放入测试集中。这可以确保测试集在多个运行期间保持一致，即使刷新数据集也是如此。新的测试集将包含20%的新实例，但它不会包含以前在训练集中的任何实例。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> zlib <span style="color:#f92672">import</span> crc32
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">is_id_in_test_set</span>(identifier, test_ratio):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> crc32(np<span style="color:#f92672">.</span>int64(identifier)) <span style="color:#f92672">&lt;</span> test_ratio <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">split_data_with_id_hash</span>(data, test_ratio, id_column):
</span></span><span style="display:flex;"><span>    ids <span style="color:#f92672">=</span> data[id_column]
</span></span><span style="display:flex;"><span>    in_test_set <span style="color:#f92672">=</span> ids<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> id_: is_id_in_test_set(id_, test_ratio))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> data<span style="color:#f92672">.</span>loc[<span style="color:#f92672">~</span>in_test_set], data<span style="color:#f92672">.</span>loc[in_test_set]
</span></span></code></pre></div><p>不幸的是，住房数据集没有标识符列。最简单的解决方案是使用行索引作为ID:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>housing_with_id <span style="color:#f92672">=</span> housing<span style="color:#f92672">.</span>reset_index()  <span style="color:#75715e"># adds an `index` column</span>
</span></span><span style="display:flex;"><span>train_set, test_set <span style="color:#f92672">=</span> split_data_with_id_hash(housing_with_id, <span style="color:#ae81ff">0.2</span>, <span style="color:#e6db74">&#34;index&#34;</span>)
</span></span></code></pre></div><p>如果使用行索引作为唯一标识符，则需要确保将新数据追加到数据集的末尾，并且不会删除任何行。果这是不可能的，那么你可以尝试使用最稳定的功能来建立一个唯一的标识符。例如，一个地区的纬度和经度保证在几百万年内是稳定的，因此您可以将它们组合成一个ID，如下所示:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>housing_with_id[<span style="color:#e6db74">&#34;id&#34;</span>] <span style="color:#f92672">=</span> housing[<span style="color:#e6db74">&#34;longitude&#34;</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span> <span style="color:#f92672">+</span> housing[<span style="color:#e6db74">&#34;latitude&#34;</span>]
</span></span><span style="display:flex;"><span>train_set, test_set <span style="color:#f92672">=</span> split_data_with_id_hash(housing_with_id, <span style="color:#ae81ff">0.2</span>, <span style="color:#e6db74">&#34;id&#34;</span>)
</span></span></code></pre></div><p>Scikit-Learn提供了一些函数，以各种方式将数据集拆分为多个子集。最简单的函数train_test_split()，它的功能与我们前面定义的shuffle_and_split_data ()函数非常相似，只是增加了几个特性。首先，有一个random_state参数，它允许您设置随机生成器种子。其次，您可以向它传递具有相同行数的多个数据集，它将按照相同的索引将它们拆分(这是非常有用的，例如，如果你有一个单独的DataFrame标签):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>train_set, test_set <span style="color:#f92672">=</span> train_test_split(housing, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>)
</span></span></code></pre></div><p>到目前为止，我们已经考虑了纯随机抽样方法。 如果您的数据集足够大（尤其是相对于属性数量而言），这通常没问题，但如果不是，您就会面临引入显着抽样偏差的风险。 当一家调查公司的员工决定给 1,000 个人打电话询问一些问题时，他们不会只是在电话簿中随机挑选 1,000 个人。 他们试图确保这 1000 人能够代表全体民众，了解他们想问的问题。 例如，美国人口中女性占 51.1%，男性占 48.9%，因此在美国进行的一项精心调查将尽力维持样本中的这一比例：511 名女性和 489 名男性（至少如果答案可能是这样的话） 因性别而异）。 这称为分层抽样：将总体分为称为层的同质子组，并从每个层中抽取正确数量的实例，以保证测试集能够代表总体。 如果进行调查的人使用纯粹随机抽样，则有大约 10.7% 的机会对女性参与者少于 48.5% 或超过 53.5% 的倾斜测试集进行抽样。 不管怎样，调查结果可能会有很大偏差。</p>
<p>假设你和一些专家聊天，他们告诉你，收入中位数是预测房价中位数的一个非常重要的属性。你可能想确保测试集代表了整个数据集中的各种收入类别。由于中位数收入是一个连续的数字属性，您首先需要创建一个收入类别属性。让我们更仔细地看看收入中位数的柱状图(回到图2-8):大多数收入中位数都聚集在1.5至6(即15,000至60,000美元)，但一些中等收入远远超过6。在数据集中为每个层提供足够数量的实例是很重要的，否则对层的重要性的估计可能会有偏差。这意味着你不应该有太多的阶层，每个阶层都应该足够大。下面的代码使用pd.cut()函数创建一个包含五个类别(标记为1到5)的income category属性;category 1的范围是0到1.5(即低于$15,000),category 2的范围是1.5到3，依此类推:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>housing[<span style="color:#e6db74">&#34;income_cat&#34;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>cut(housing[<span style="color:#e6db74">&#34;median_income&#34;</span>],
</span></span><span style="display:flex;"><span>                               bins<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0.</span>, <span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">3.0</span>, <span style="color:#ae81ff">4.5</span>, <span style="color:#ae81ff">6.</span>, np<span style="color:#f92672">.</span>inf],
</span></span><span style="display:flex;"><span>                               labels<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>])
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>housing[<span style="color:#e6db74">&#34;income_cat&#34;</span>]<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>sort_index()<span style="color:#f92672">.</span>plot<span style="color:#f92672">.</span>bar(rot<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, grid<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Income category&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;Number of districts&#34;</span>)
</span></span><span style="display:flex;"><span>save_fig(<span style="color:#e6db74">&#34;housing_income_cat_bar_plot&#34;</span>)  <span style="color:#75715e"># extra code</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="https://img-blog.csdnimg.cn/b3edd0a375d940418210cf0c52a3d1f8.png#pic_center" alt="在这里插入图片描述"></p>
<p>现在您已准备好根据收入类别进行分层抽样。 Scikit-Learn 在 sklearn.model_selection 包中提供了许多拆分器类，这些类实现了各种策略来将数据集拆分为训练集和测试集。 每个拆分器都有一个 split() 方法，该方法返回同一数据的不同训练/测试拆分的迭代器。</p>
<p>准确地说，split()方法生成的是训练和测试指标，而不是数据本身。如果你想更好地估计你的模型的性能，有多个拆分是很有用的，当我们在本章后面讨论交叉验证的时候你会看到。例如，下面的代码生成同一数据集的10个不同的分层拆分:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> StratifiedShuffleSplit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>splitter <span style="color:#f92672">=</span> StratifiedShuffleSplit(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>strat_splits <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> train_index, test_index <span style="color:#f92672">in</span> splitter<span style="color:#f92672">.</span>split(housing, housing[<span style="color:#e6db74">&#34;income_cat&#34;</span>]):
</span></span><span style="display:flex;"><span>    strat_train_set_n <span style="color:#f92672">=</span> housing<span style="color:#f92672">.</span>iloc[train_index]
</span></span><span style="display:flex;"><span>    strat_test_set_n <span style="color:#f92672">=</span> housing<span style="color:#f92672">.</span>iloc[test_index]
</span></span><span style="display:flex;"><span>    strat_splits<span style="color:#f92672">.</span>append([strat_train_set_n, strat_test_set_n])
</span></span></code></pre></div><p>现在就可以拆分了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>strat_train_set, strat_test_set <span style="color:#f92672">=</span> strat_splits[<span style="color:#ae81ff">0</span>]
</span></span></code></pre></div><p>或者，因为分层抽样很常见，所以有一个更简单的方法，使用带stratify参数的train_test_split ()函数来获得单个拆分:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>strat_train_set, strat_test_set <span style="color:#f92672">=</span> train_test_split(
</span></span><span style="display:flex;"><span>    housing, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, stratify<span style="color:#f92672">=</span>housing[<span style="color:#e6db74">&#34;income_cat&#34;</span>], random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>)
</span></span></code></pre></div><p>让我们看看这是否像预期的那样工作。你可以从测试集中的收入类别比例开始:</p>
<p><img src="https://img-blog.csdnimg.cn/81a3ff3016f2418ea4ed7ebfe15ebc24.png#pic_center" alt="在这里插入图片描述"></p>
<p>使用类似的代码，您可以测量整个数据集中的收入类别比例。下图比较了总体数据集、分层抽样生成的测试集和纯粹随机抽样生成的测试集中的收入类别比例。如您所见，使用分层抽样生成的测试集的收入类别比例几乎与完整数据集中的收入类别比例相同，而使用纯粹随机抽样生成的测试集是倾斜的。</p>
<p><img src="https://img-blog.csdnimg.cn/dac81b28ca684de7aa2a0088a374fdde.png#pic_center" alt="在这里插入图片描述"></p>
<p>您不会再次使用income_cat列，所以您不妨删除它，将数据恢复到原始状态:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> set_ <span style="color:#f92672">in</span> (strat_train_set, strat_test_set):
</span></span><span style="display:flex;"><span>    set_<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#34;income_cat&#34;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p>我们在测试集生成上花了相当多的时间，这是有充分理由的:这是一个机器学习项目中经常被忽视但非常关键的部分。此外，当我们讨论交叉验证时，这些想法中的许多将是有用的。现在是时候进入下一个阶段了:探索数据。</p>
        </article>
    </div>

    
       	






<div id="comments" class="post-comments">
  <div class="comment-head">
    <div class="comment-headline">
      <i class="fa fa-comments fa-fw"></i>
      
    </div>
  
  </div>
  <div class="comment-wrap">
  
  
    <div>      
      <div class="comment-loading">
    <i class="fa fa-sync fa-spin"></i>
  </div>
      <div class="waline-container"></div>



    </div>
  
  </div>
</div>  

    
</div>




<script>
    
    
    
    
    
    
    

    
    
</script>


<script>
    let activeElement;
    let elements;
    
    

    
        
    
    
    
    

    
    
    

    
        
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    
    

    

    
    
    

    
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    
</script>
 





<script>
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
</script>



<script>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
</script>
<script>
    
    
    
    
    

    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    
    
    
    
            
    
            
    
    
    
            
    
    
    
    
</script><aside class="Qc_aside">

<section class="Qc_aside_item tags"> 
    <div class="Qc_aside_item-title"> 
        <i class="iconfont icon-A67" style="margin-right: 8px;font-size: 17px"></i> 
        <span class="text">文章分类</span> 
        <span class="qccq_mac"></span> 
    </div> 
    <div class="Qc_aside_item-contain" style="padding:10px"> 
        <div class="tag"></div> 
		<ul class="list">
			
			
			   
			<li class="item"> 
				<a class="link" href="/categories/bootstraptable/">BootstrapTable </a>
				<span class="widget__counter widget__counter--bubble">1</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/centos/">CentOS </a>
				<span class="widget__counter widget__counter--bubble">4</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/chrome%E6%89%A9%E5%B1%95/">Chrome扩展 </a>
				<span class="widget__counter widget__counter--bubble">1</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/cocos2d-x/">cocos2d-x </a>
				<span class="widget__counter widget__counter--bubble">1</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/docker/">Docker </a>
				<span class="widget__counter widget__counter--bubble">1</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/extjs/">extjs </a>
				<span class="widget__counter widget__counter--bubble">1</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/fastadmin/">Fastadmin </a>
				<span class="widget__counter widget__counter--bubble">2</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/git/">Git </a>
				<span class="widget__counter widget__counter--bubble">5</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/golang/">golang </a>
				<span class="widget__counter widget__counter--bubble">36</span>
			</li>
			
			   
			<li class="item"> 
				<a class="link" href="/categories/java/">Java </a>
				<span class="widget__counter widget__counter--bubble">3</span>
			</li>
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
			
			   
	</div>
</section>




<section class="Qc_aside_item tags"> 
    <div class="Qc_aside_item-title"> 
        <i class="iconfont icon-A67" style="margin-right: 8px;font-size: 17px"></i> 
        <span class="text">标签云</span> 
        <span class="xccx_mac"></span> 
    </div> 
     <div class="Qc_aside_item-contain" style="padding:10px"> 
        <div class="tag"></div> 
        <ul class="cloud">
            

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/abstract/" title="abstract">abstract</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/ag-grid/" title="ag-grid">ag-grid</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/apache/" title="Apache">Apache</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/array/" title="array">array</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/bootstraptable-%E9%9A%90%E8%97%8F/%E6%98%BE%E7%A4%BA%E8%A1%A8%E6%A0%BC%E8%A1%8C/" title="BootstrapTable 隐藏/显示表格行">BootstrapTable 隐藏/显示表格行</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/branch/" title="branch">branch</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/break/" title="break">break</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/centos/" title="CentOS">CentOS</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/centos7/" title="CentOS7">CentOS7</a>
            </li>

                
            <li class="item">
                <a style="background:#4C83FF" href="/tags/channel/" title="channel">channel</a>
            </li>

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                

                
         </ul> 
        </div> 
    </section>



    

    <section class="sticky_layout"><style>

    .card-widget:first-child {
        margin-top: 0
    }

    @media screen and (max-width:900px) {
        .card-widget:first-child {
            margin-top: 20px
        }
    }

     .card-widget {
        position: relative;
        overflow: hidden;
        margin-top: 20px;
        padding: 20px 24px;
        color:var(--main)
    }

     .card-widget,
    #recent-posts>.recent-post-item,
    .cardHover,
    .error404 #error-wrap .error-content,
    .layout>.recent-posts .pagination>:not(.space),
    .layout>div:first-child:not(.recent-posts) {
        border-radius: 8px;
        background: var(--background);
        -webkit-box-shadow: var(--card-box-shadow);
        box-shadow: var(--card-box-shadow);
        -webkit-transition: all .3s;
        -moz-transition: all .3s;
        -o-transition: all .3s;
        -ms-transition: all .3s;
        transition: all .3s
    }

    .card-widget:hover,
    #recent-posts>.recent-post-item:hover,
    .cardHover:hover,
    .error404 #error-wrap .error-content:hover,
    .layout>.recent-posts .pagination>:not(.space):hover,
    .layout>div:first-child:not(.recent-posts):hover {
        -webkit-box-shadow: var(--card-hover-box-shadow);
        box-shadow: var(--card-hover-box-shadow)
    }



    .item-headline {
        padding-bottom: 6px;
        font-size: 1.2em
    }

     .item-headline span {
        margin-left: 6px
    }

   
 
     @media screen and (min-width:900px) {
        .sticky_layout {
            position: sticky;
            position: -webkit-sticky;
            top: 60px;
            -webkit-transition: top .3s;
            -moz-transition: top .3s;
            -o-transition: top .3s;
            -ms-transition: top .3s;
            transition: top .3s
        }
    } 

    

 

    



    #card-toc .toc-percentage {
        float: right;
        margin-top: -9px;
        color: #a9a9a9;
        font-style: italic;
        font-size: 140%
    }

    #card-toc .toc-content {
        overflow-y: scroll;
        overflow-y: overlay;
        margin: 0 -24px;
        max-height: calc(100vh - 120px)
    }

    @media screen and (max-width:900px) {
         #card-toc .toc-content {
            max-height: calc(100vh - 140px)
        }
    }

     #card-toc .toc-content>* {
        margin: 0 20px !important
    }



     #card-toc .toc-content>*>.toc-item>.toc-child {
        margin-left: 10px;
        padding-left: 10px;
        border-left: 1px solid var(--dark-grey)
    }

    #card-toc .toc-content:not(.is-expand) .toc-child {
        display: none
    }

    @media screen and (max-width:900px) {
        #card-toc .toc-content:not(.is-expand) .toc-child {
            display: block !important
        }
    }

   #card-toc .toc-content:not(.is-expand) .toc-item.active .toc-child {
        display: block
    }

    #card-toc .toc-content li,
     #card-toc .toc-content ol {
        list-style: none
    }

     #card-toc .toc-content>ol {
        padding: 0 !important
    }

    #card-toc .toc-content ol {
        margin: 0;
        padding-left: 18px
    }

    #card-toc .toc-content .toc-link {
        display: block;
        margin: 4px 0;
        padding: 1px 6px;
        color: var(--toc-link-color);
        -webkit-transition: all .2s ease-in-out;
        -moz-transition: all .2s ease-in-out;
        -o-transition: all .2s ease-in-out;
        -ms-transition: all .2s ease-in-out;
        transition: all .2s ease-in-out
    }

     #card-toc .toc-content .toc-link:hover {
        color: #49b1f5
    }

    #card-toc .toc-content .toc-link.active {
        background: #00c4b6;
        color: #fff
    }

     .sticky_layout:only-child>:first-child {
        margin-top: 20px
    }


</style>
    <div class="card-widget" id="card-toc">
        <div class="item-headline">
            <i class="fa fa-bars"></i>
            <span>目录</span>
            <span class="toc-percentage">0</span>
        </div>
        <div class="toc-content"><ol class="toc">
                        <li class="toc-item toc-level-3">
                            <a class="toc-link" href="#%e4%bd%bf%e7%94%a8%e7%9c%9f%e5%ae%9e%e6%95%b0%e6%8d%ae" aria-label="使用真实数据" data-pjax-state="anchor">
                                <span class="toc-number">1</span> 
                                <span class="toc-text">使用真实数据</span>
                            </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e7%9c%8b%e5%9b%be%e8%af%b4%e8%af%9d" aria-label="看图说话" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">看图说话</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e6%a1%86%e6%9e%b6%e9%97%ae%e9%a2%98" aria-label="框架问题" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">框架问题</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e9%80%89%e6%8b%a9%e6%80%a7%e8%83%bd%e5%ba%a6%e9%87%8f" aria-label="选择性能度量" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">选择性能度量</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e6%a3%80%e6%9f%a5%e5%81%87%e8%ae%be" aria-label="检查假设" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">检查假设</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e4%b8%8b%e8%bd%bd%e6%95%b0%e6%8d%ae" aria-label="下载数据" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">下载数据</span>
                        </a></li>

                    <li class="toc-item toc-level-2">
                        <a class="toc-link" href="#%e5%88%9b%e5%bb%ba%e6%b5%8b%e8%af%95%e9%9b%86" aria-label="创建测试集" data-pjax-state="anchor">
                            <span class="toc-number">3</span> 
                            <span class="toc-text">创建测试集</span>
                        </a>
                    </li>
            </ol>

        </div>
    </div>






<script>

    const btf = {
    
        scrollToDest: (pos, time = 500) => {
            const currentPos = window.pageYOffset
            if (currentPos > pos) pos = pos - 70
        
            if ('scrollBehavior' in document.documentElement.style) {
                window.scrollTo({
                top: pos,
                behavior: 'smooth'
                })
                return
            }
        
            let start = null
            pos = +pos
            window.requestAnimationFrame(function step (currentTime) {
                start = !start ? currentTime : start
                const progress = currentTime - start
                if (currentPos < pos) {
                window.scrollTo(0, ((pos - currentPos) * progress / time) + currentPos)
                } else {
                window.scrollTo(0, currentPos - ((currentPos - pos) * progress / time))
                }
                if (progress < time) {
                window.requestAnimationFrame(step)
                } else {
                window.scrollTo(0, pos)
                }
            })
        },
    
       
        getEleTop: ele => {
            let actualTop = ele.offsetTop
            let current = ele.offsetParent
        
            while (current !== null) {
                actualTop += current.offsetTop
                current = current.offsetParent
            }
        
            return actualTop
        },

        updateAnchor: (anchor) => {
            if (anchor !== window.location.hash) {
                if (!anchor) anchor = location.pathname
                const title = "秋码记录"
                window.history.replaceState({
                    url: location.href,
                    title
                }, title, anchor)
            }
        },


        throttle: function (func, wait, options) {
            let timeout, context, args
            let previous = 0
            if (!options) options = {}
        
            const later = function () {
                previous = options.leading === false ? 0 : new Date().getTime()
                timeout = null
                func.apply(context, args)
                if (!timeout) context = args = null
            }
        
            const throttled = function () {
                const now = new Date().getTime()
                if (!previous && options.leading === false) previous = now
                
                const remaining = wait - (now - previous)
                context = this
                args = arguments
                if (remaining <= 0 || remaining > wait) {
                    if (timeout) {
                        clearTimeout(timeout)
                        timeout = null
                    }
                    previous = now
                    func.apply(context, args)
                    if (!timeout) context = args = null
                } else if (!timeout && options.trailing !== false) {
                    timeout = setTimeout(later, remaining)
                }
            }
        
            return throttled
        },

        getScrollPercent: (currentTop, ele) => {
            const docHeight = ele.clientHeight
            const winHeight = document.documentElement.clientHeight
            const headerHeight = ele.offsetTop
            const contentMath = (docHeight > winHeight) ? (docHeight - winHeight) : (document.documentElement.scrollHeight - winHeight)
            const scrollPercent = (currentTop - headerHeight) / (contentMath)
            const scrollPercentRounded = Math.round(scrollPercent * 100)
            const percentage = (scrollPercentRounded > 100) ? 100 : (scrollPercentRounded <= 0) ? 0 : scrollPercentRounded
            return percentage
        },




    }  



     

    const scrollFnToDo = function () {
      const isToc = true 
      const isAnchor = true 
      const $article = document.getElementById('article-container')
  
      if (!($article && (isToc || isAnchor))) return
  
      let $tocLink, $cardToc, autoScrollToc, $tocPercentage, isExpand
  
      if (isToc) {
        const $cardTocLayout = document.getElementById('card-toc')
        $cardToc = $cardTocLayout.getElementsByClassName('toc-content')[0]
        $tocLink = $cardToc.querySelectorAll('.toc-link')
        $tocPercentage = $cardTocLayout.querySelector('.toc-percentage')
        isExpand = $cardToc.classList.contains('is-expand')
  
        window.mobileToc = {
          open: () => {
            $cardTocLayout.style.cssText = 'animation: toc-open .3s; opacity: 1; right: 55px'
          },
  
          close: () => {
            $cardTocLayout.style.animation = 'toc-close .2s'
            setTimeout(() => {
              $cardTocLayout.style.cssText = "opacity:''; animation: ''; right: ''"
            }, 100)
          }
        }
  
        
        $cardToc.addEventListener('click', e => {
          e.preventDefault()
          const target = e.target.classList
          if (target.contains('toc-content')) return
          const $target = target.contains('toc-link')
            ? e.target
            : e.target.parentElement
          btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI($target.getAttribute('href')).replace('#', ''))), 300)
          if (window.innerWidth < 900) {
            window.mobileToc.close()
          }
        })
  
        autoScrollToc = item => {
          const activePosition = item.getBoundingClientRect().top
          const sidebarScrollTop = $cardToc.scrollTop
          if (activePosition > (document.documentElement.clientHeight - 100)) {
            $cardToc.scrollTop = sidebarScrollTop + 150
          }
          if (activePosition < 100) {
            $cardToc.scrollTop = sidebarScrollTop - 150
          }
        }
      }
  
      
      const list = $article.querySelectorAll('h1,h2,h3,h4,h5,h6')
      let detectItem = ''
      const findHeadPosition = function (top) {
        if (top === 0) {
          return false
        }
  
        let currentId = ''
        let currentIndex = ''
  
        list.forEach(function (ele, index) {
          if (top > btf.getEleTop(ele) - 80) {
            const id = ele.id
            currentId = id ? '#' + encodeURI(id) : ''
            currentIndex = index
          }
        })
  
        if (detectItem === currentIndex) return
  
        if (isAnchor) btf.updateAnchor(currentId)
  
        detectItem = currentIndex
  
        if (isToc) {
          $cardToc.querySelectorAll('.active').forEach(i => { i.classList.remove('active') })
  
          if (currentId === '') {
            return
          }
  
          const currentActive = $tocLink[currentIndex]
          currentActive.classList.add('active')
  
          setTimeout(() => {
            autoScrollToc(currentActive)
          }, 0)
  
          if (isExpand) return
          let parent = currentActive.parentNode
  
          for (; !parent.matches('.toc'); parent = parent.parentNode) {
            if (parent.matches('li')) parent.classList.add('active')
          }
        }
      }
  
      
      window.tocScrollFn = btf.throttle(() => {
        const currentTop = window.scrollY || document.documentElement.scrollTop
        
         if(isToc){
          $tocPercentage.textContent = btf.getScrollPercent(currentTop, $article)
        }
        findHeadPosition(currentTop)
      }, 100)
  
      window.addEventListener('scroll', tocScrollFn)
    }
  

    scrollFnToDo()
</script>





    </section>
     

</aside></div>
	<footer class="Qc_footer">
		<div class="Qc_container">
			<div class="item">
				<p>2018 - 2023 版权所有 ©<a href="http://beian.miit.gov.cn/">闽ICP备2021005633号-2</a></p>
			</div>
			<div class="item">
				<p>
					<strong>本站由 <span style="color:blue;font:bold;">Hugo</span> 驱动的 
						<a href="https://github.com/zhenqicai/hugo-theme-kiwi" target="_blank" >hugo-theme-kiwi V0.0.1</a> 主题强力支撑</strong>
				</p>
			</div>
		</div>
		</div>
	</footer>

	<style>
		.joe_action {
			position: fixed;
			bottom: 90px;
			right: 30px;
			z-index: 333;
		}


		.joe_action_item.scroll.active {
			visibility: visible;
			-webkit-transform: scale(1);
			transform: scale(1);
		}

		.joe_action_item.scroll {
			visibility: hidden;
			-webkit-transform: scale(0);
			transform: scale(0);
			transition: visibility 0.35s, -webkit-transform 0.35s;
			transition: visibility 0.35s, transform 0.35s;
			transition: visibility 0.35s, transform 0.35s, -webkit-transform 0.35s;
		}

		.joe_action_item {
			box-shadow: rgb(0 0 0 / 10%) 0px 0px 10px, rgb(0 0 0 / 20%) 0px 5px 20px;
			background: var(--darkreader-bg--background);
		}
		.joe_action_item {
			position: relative;
			display: flex;
			align-items: center;
			justify-content: center;
			width: 40px;
			height: 40px;
			background: var(--background);
			border-radius: 50%;
			cursor: pointer;
			margin-top: 15px;
			box-shadow: 0 0 10px rgb(0 0 0 / 10%), 0 5px 20px rgb(0 0 0 / 20%);
		}
		.joe_action_item svg {
			position: absolute;
			width: 25px;
			height: 25px;
			fill: var(--theme);
		}



		.joe_action_item.mode svg{-webkit-transform:scale(0);transform:scale(0);opacity:0}
		.joe_action_item.mode svg.active{-webkit-transform:scale(1);transform:scale(1);opacity:1}
		
	</style>


	<div class="joe_action">
		<div class="joe_action_item scroll ">
			<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="25" height="25">
				<path d="M725.902 498.916c18.205-251.45-93.298-410.738-205.369-475.592l-6.257-3.982-6.258 3.414c-111.502 64.853-224.711 224.142-204.8 475.59-55.751 53.476-80.214 116.623-80.214 204.8v15.36l179.2-35.27c11.378 40.39 58.596 69.973 113.21 69.973 54.613 0 101.262-29.582 112.64-68.836l180.337 36.41v-15.36c-.569-89.885-25.031-153.6-82.489-206.507zM571.733 392.533c-33.564 31.29-87.04 28.445-118.329-5.12s-28.444-87.04 5.12-117.76c33.565-31.289 87.04-28.444 118.33 5.12s28.444 86.471-5.12 117.76zm-56.32 368.64c-35.84 0-64.284 29.014-64.284 64.285 0 35.84 54.044 182.613 64.284 182.613s64.285-146.773 64.285-182.613c0-35.271-29.014-64.285-64.285-64.285z"></path>
			</svg>
		</div>
		<div class="joe_action_item mode">
			<svg class="icon-1 " viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="25" height="25">
				<path d="M587.264 104.96c33.28 57.856 52.224 124.928 52.224 196.608 0 218.112-176.128 394.752-393.728 394.752-29.696 0-58.368-3.584-86.528-9.728C223.744 832.512 369.152 934.4 538.624 934.4c229.376 0 414.72-186.368 414.72-416.256 1.024-212.992-159.744-389.12-366.08-413.184z"></path>
				<path d="M340.48 567.808l-23.552-70.144-70.144-23.552 70.144-23.552 23.552-70.144 23.552 70.144 70.144 23.552-70.144 23.552-23.552 70.144zM168.96 361.472l-30.208-91.136-91.648-30.208 91.136-30.208 30.72-91.648 30.208 91.136 91.136 30.208-91.136 30.208-30.208 91.648z"></path>
			</svg>
			<svg class="icon-2 active" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="25" height="25">
				<path d="M234.24 512a277.76 277.76 0 1 0 555.52 0 277.76 277.76 0 1 0-555.52 0zM512 187.733a42.667 42.667 0 0 1-42.667-42.666v-102.4a42.667 42.667 0 0 1 85.334 0v102.826A42.667 42.667 0 0 1 512 187.733zm-258.987 107.52a42.667 42.667 0 0 1-29.866-12.373l-72.96-73.387a42.667 42.667 0 0 1 59.306-59.306l73.387 72.96a42.667 42.667 0 0 1 0 59.733 42.667 42.667 0 0 1-29.867 12.373zm-107.52 259.414H42.667a42.667 42.667 0 0 1 0-85.334h102.826a42.667 42.667 0 0 1 0 85.334zm34.134 331.946a42.667 42.667 0 0 1-29.44-72.106l72.96-73.387a42.667 42.667 0 0 1 59.733 59.733l-73.387 73.387a42.667 42.667 0 0 1-29.866 12.373zM512 1024a42.667 42.667 0 0 1-42.667-42.667V878.507a42.667 42.667 0 0 1 85.334 0v102.826A42.667 42.667 0 0 1 512 1024zm332.373-137.387a42.667 42.667 0 0 1-29.866-12.373l-73.387-73.387a42.667 42.667 0 0 1 0-59.733 42.667 42.667 0 0 1 59.733 0l72.96 73.387a42.667 42.667 0 0 1-29.44 72.106zm136.96-331.946H878.507a42.667 42.667 0 1 1 0-85.334h102.826a42.667 42.667 0 0 1 0 85.334zM770.987 295.253a42.667 42.667 0 0 1-29.867-12.373 42.667 42.667 0 0 1 0-59.733l73.387-72.96a42.667 42.667 0 1 1 59.306 59.306l-72.96 73.387a42.667 42.667 0 0 1-29.866 12.373z"></path>
			</svg>
		</div>
	</div>

	


	
	

	

	
	
	<script src="/js/highlight.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

   

   <script>
	 function registerImageLoadEvent() {
		const images = document.querySelectorAll('.sidebar img, .Qc_post img, .vendors-list img');
				
		const callback = (entries) => {
			entries.forEach(item => {
				if (item.intersectionRatio > 0) {
					let ele = item.target;
					let imgSrc = ele.getAttribute('src');
					ele.setAttribute("src","1.png")
					ele.setAttribute("data-lazy-src",imgSrc)
					ele.classList.add("lazyload")
			
				}
			})
		};

		Array.from(images).forEach(img => {
			const bg = '/images/loading.gif' 

			img.setAttribute("data-lazy-src",img.src)
			img.src = bg
			
		})
		
		
		
		
		
		
		
		
		
			

		
		
		
	}

	registerImageLoadEvent()

   </script>




 

 <script src="/js/lazyload.life.min.js"></script>

 <script>
	const lazyloadImg = () => {
      window.lazyLoadInstance = new LazyLoad({
        elements_selector: 'img',
        threshold: 0,
        data_src: 'lazy-src'
      })
    }

	lazyloadImg()
 </script>


	</div>
</body>

<script>

	
	
	
	
	
	
	
	
	


	
	

	
	
				
	

	
	
	
	

	

	

	
	
	
	
	

	
	
		
	
	   </script>

</html>











<script>
	
    
	var mybutton = document.querySelector(".joe_action .joe_action_item.scroll")
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            
            
			mybutton.classList.add("active")
        } else {
            
            
			mybutton.classList.remove("active")
        }
    };

	mybutton.addEventListener("click",() => {
		document.documentElement.scrollTop = document.body.scrollTop = 0;
	})
	


</script>



<script>
	var themeBtn = document.querySelector(".joe_action .joe_action_item.mode")
	let icon_1 = document.querySelector(".joe_action .joe_action_item.mode .icon-1")
	let icon_2 = document.querySelector(".joe_action .joe_action_item.mode .icon-2")
    themeBtn.addEventListener("click", () => {
		
        if (icon_1.classList.contains("active")) {
            icon_1.classList.remove('active');
			icon_2.classList.add('active');
			document.querySelector("html").removeAttribute("data-night")
            localStorage.setItem("pref-theme", 'light');
        } else {
			icon_2.classList.remove('active');
			icon_1.classList.add('active');
			document.querySelector("html").setAttribute("data-night","night")
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>



<script>
    
    

    
    
    

    
    
    
    
    
    

    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
</script>



